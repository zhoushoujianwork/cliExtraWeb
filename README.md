# Q Chat Manager - 基于 cliExtra 的 Web 管理界面

这是一个使用 Flask 框架实现的前端管理 `cliExtra` 的 Web 服务。

## 功能特性

### 界面设计
- **专业 LOGO**: 集成 AI 主题的橙黄色 LOGO，支持 SVG 矢量显示
- **现代导航栏**: 渐变色背景，清晰的品牌标识和副标题
- **响应式设计**: 适配不同屏幕尺寸，确保最佳用户体验

### Q CLI 实例管理
- **实例创建**: 通过 Web 界面创建新的 cliExtra 实例
- **实例监控**: 实时显示当前活跃的 cliExtra 实例状态
- **实例交互**: 向实例发送消息并获取输出
- **实例接管**: 支持用户随时接管终端进行交互
- **批量清理**: 一键清理所有实例

### 🆕 交互终端功能
- **双模式终端**: 支持只读监控和完全交互两种模式
- **一键切换**: 在只读和交互模式之间无缝切换
- **实时交互**: 直接在浏览器中与 cliExtra 实例交互
- **完整终端体验**: 支持所有终端快捷键和功能
- **安全分离**: 可随时断开交互，保持实例运行

#### 终端模式说明
1. **只读模式** (默认)
   - 实时查看实例日志输出
   - 安全的监控模式
   - 不会影响实例运行

2. **交互模式**
   - 完全的终端交互体验
   - 支持命令输入和执行
   - 实时双向通信
   - 支持 Ctrl+C、Tab 补全等快捷键

### 核心实现
- **基于 cliExtra 命令**: 使用 `cliExtra list`、`cliExtra start`、`cliExtra stop` 等命令
- **智能解析**: 自动解析 `cliExtra list` 输出，正确处理"没有活跃的实例"情况
- **状态同步**: 实时同步实例状态，自动清理不存在的实例
- **线程安全**: 使用锁机制确保多线程环境下的数据一致性
- **WebSocket 通信**: 基于 Socket.IO 的实时双向通信
- **tmux 集成**: 通过 pexpect 与 tmux 会话进行交互

### 技术架构
- **后端**: Flask + Python + Socket.IO
- **前端**: HTML + CSS + JavaScript + xterm.js
- **实例管理**: 基于 cliExtra 命令行工具
- **终端交互**: pexpect + tmux 会话管理
- **日志系统**: 完整的操作日志记录

## 安装要求

1. **安装 cliExtra**: 确保系统已安装 `cliExtra` 命令
2. **Python 环境**: Python 3.7+
3. **系统依赖**: tmux (用于终端交互功能)
4. **Python 依赖**: 见 `requirements.txt`
   ```bash
   pip install -r requirements.txt
   ```

## 快速开始

1. **启动服务**: `./start.sh`
2. **访问界面**: 打开浏览器访问 Web 界面
3. **管理实例**: 在"Q CLI 实例"面板中管理 cliExtra 实例
4. **交互终端**: 选择实例监控后，点击"交互模式"按钮进行终端交互

## 使用指南

### 基本操作
1. 创建实例 → 选择角色和配置
2. 监控实例 → 查看实时日志输出
3. 切换交互模式 → 直接与实例交互
4. 发送消息 → 通过聊天界面与实例对话

### 终端交互
1. **开始监控**: 点击实例的"监控"按钮
2. **切换模式**: 点击终端右上角的"交互模式"按钮
3. **直接输入**: 在交互模式下直接输入命令
4. **返回只读**: 点击"只读模式"按钮返回日志监控

## 文档

所有详细文档都放在 `docs` 目录下，包括：
- [快速开始指南](docs/quick_start.md)
- [功能特性说明](docs/features.md)
- [交互终端使用指南](docs/interactive_terminal_guide.md)
- [故障排除指南](docs/troubleshooting.md)
- [项目结构说明](docs/project_structure.md)

## 开发说明

- 实例管理器位于 `app/services/instance_manager.py`
- Web终端管理器位于 `app/services/web_terminal.py`
- WebSocket处理位于 `app/views/websocket.py`
- 支持程序化交互和用户手动接管
- 自动处理实例状态同步和清理

## 更新日志

### v1.2.0 (最新)
- 🆕 新增创建实例完整等待状态显示
- 🆕 创建按钮加载动画和禁用状态
- 🆕 实时进度条和步骤指示器
- 🆕 完善的错误处理和状态恢复
- 🔧 优化用户体验，防止重复点击
- 🔧 增加2分钟超时保护机制
- 📚 新增详细的功能文档和测试文件

### v1.1.0
- 🆕 新增交互终端功能
- 🆕 支持只读/交互模式切换
- 🆕 完整的终端快捷键支持
- 🆕 WebSocket 双向通信
- 🆕 tmux 会话管理
- 🔧 优化终端显示效果
- 🔧 增强错误处理机制

### v1.0.0
- ✅ 基础实例管理功能
- ✅ 只读终端监控
- ✅ 实例创建和清理
- ✅ 基础 Web 界面







